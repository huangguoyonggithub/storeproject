<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zxx">
<!--<![endif]-->
<!-- Begin Head -->

<head>
    <title>CSGO装备商城</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <meta name="MobileOptimized" content="320">
    <!--导入核心文件-->
    <script src="../bootstrap3/js/holder.js"></script>
    <link href="../bootstrap3/css/bootstrap.css" rel="stylesheet" type="text/css">
    <script src="../bootstrap3/jquery-1.9.1.min.js"></script>
    <script src="../bootstrap3/js/bootstrap.js"></script>
    <!--Start Style -->
    <link rel="stylesheet" type="text/css" href="../css/fonts.css">
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../css/icofont.min.css">
	<link rel="stylesheet" href="../css/swiper.min.css">
    <!--Page Specific -->
    <link rel="stylesheet" type="text/css" href="../css/nice-select.css">
    <!--Custom Style -->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
	<link rel="stylesheet" id="theme-change" type="text/css" href="">
</head>


<body>
<div class="loader">
	  <div class="spinner">
		<img src="../picture/loader.gif" alt="">
	  </div> 
	</div>
    <!-- Main Body -->
    <div class="page-wrapper">
		<!-- Header Start -->
		<header class="header-wrapper main-header" id="header">
			<!--      header内容      -->
		</header>
		<!--Sidebar Start-->
		<aside class="sidebar-wrapper" id="sidebar">
			<!--sidebar内容-->
		</aside>
        <!-- Container Start -->
        <div class="page-wrapper">
            <div class="main-content">
                <!-- Page Title Start -->
                <div class="row">
                    <div class="col xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <div class="page-title-wrapper">
                            <div class="page-title-box">
                                <h4 class="page-title">商品详情</h4>
                            </div>
                            <div class="breadcrumb-list">
                                <ul>
                                    <li class="breadcrumb-link active">商品详情</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Products view Start -->
               <!--===Start Index2 Product single Section===-->
				<div class="int-product-single">
					<div class="row">
						<div class="col-lg-4 col-md-4 col-sm-12">
							<div class="int-thumb-slider">
								<!-- Swiper -->
								<div class="swiper-container gallery-top">
									<div class="swiper-wrapper">
									  <div class="swiper-slide" id="good-image"><img src="../picture/thumb1.png" alt="product-img"></div>
									</div>
								</div>
							</div>
							<div class="int-minithumb-slider">
								  <div class="swiper-container gallery-thumbs">
									<div class="swiper-wrapper">
										<div class="int-thumb-sidebar">
											<div class="int-price-detail">
												<h1 id="good-title">Supreme Pearl Super Chair, wooden Yellow</h1>
												<ul>
													<li  style="color: #00acee"><span id="good-price1"></span><span>￥</span></li>
													<li><span id="good-price2"></span><span>￥</span></li>
													<li id="good-type">on offer</li>
													<br>
													现有库存：<li id="good-num">3 Customer Reviews</li>件
												</ul>
											</div>
											<div class="int-quantity-stock">
												<ul>
													<li>数量</li>
													<li>
														<div class="fd-pro-quantity">
															<div class="quantity-wrapper">
																<div class="input-group">
																	<input type="text" class="quantity" id="num" value="2">
																	<span class="quantity-minus quantity-minus2" style="color: #00acee">-</span>
																	<span class="quantity-plus quantity-plus2" style="color: #00acee">+</span>
																</div>
															</div>
														</div>
													</li>
													<li>
														<button type="button" class="ad-btn" id="add-to-cart">加入购物车</button>
													</li>
													<li>
														<a href="javascript:;" id="add-to-collect" class="svg-icon">
															<svg viewbox="0 -28 512.001 512" xmlns="http://www.w3.org/2000/svg">
																<path d="m256 455.515625c-7.289062 0-14.316406-2.640625-19.792969-7.4375-20.683593-18.085937-40.625-35.082031-58.21875-50.074219l-.089843-.078125c-51.582032-43.957031-96.125-81.917969-127.117188-119.3125-34.644531-41.804687-50.78125-81.441406-50.78125-124.742187 0-42.070313 14.425781-80.882813 40.617188-109.292969 26.503906-28.746094 62.871093-44.578125 102.414062-44.578125 29.554688 0 56.621094 9.34375 80.445312 27.769531 12.023438 9.300781 22.921876 20.683594 32.523438 33.960938 9.605469-13.277344 20.5-24.660157 32.527344-33.960938 23.824218-18.425781 50.890625-27.769531 80.445312-27.769531 39.539063 0 75.910156 15.832031 102.414063 44.578125 26.191406 28.410156 40.613281 67.222656 40.613281 109.292969 0 43.300781-16.132812 82.9375-50.777344 124.738281-30.992187 37.398437-75.53125 75.355469-127.105468 119.308594-17.625 15.015625-37.597657 32.039062-58.328126 50.167969-5.472656 4.789062-12.503906 7.429687-19.789062 7.429687zm-112.96875-425.523437c-31.066406 0-59.605469 12.398437-80.367188 34.914062-21.070312 22.855469-32.675781 54.449219-32.675781 88.964844 0 36.417968 13.535157 68.988281 43.882813 105.605468 29.332031 35.394532 72.960937 72.574219 123.476562 115.625l.09375.078126c17.660156 15.050781 37.679688 32.113281 58.515625 50.332031 20.960938-18.253907 41.011719-35.34375 58.707031-50.417969 50.511719-43.050781 94.136719-80.222656 123.46875-115.617188 30.34375-36.617187 43.878907-69.1875 43.878907-105.605468 0-34.515625-11.605469-66.109375-32.675781-88.964844-20.757813-22.515625-49.300782-34.914062-80.363282-34.914062-22.757812 0-43.652344 7.234374-62.101562 21.5-16.441406 12.71875-27.894532 28.796874-34.609375 40.046874-3.453125 5.785157-9.53125 9.238282-16.261719 9.238282s-12.808594-3.453125-16.261719-9.238282c-6.710937-11.25-18.164062-27.328124-34.609375-40.046874-18.449218-14.265626-39.34375-21.5-62.097656-21.5zm0 0"></path>
															</svg>
														</a>
													</li>
												</ul>
											</div>
										</div>
									</div>
								  </div>
								<!-- Swiper -->
							</div>
						</div>
						<div class="col-lg-8 col-md-8 col-sm-12">
							<div class="row">
								<!-- Styled Table Card-->
								<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
									<div class="card table-card">
										<div class="card-header pb-0">
											<h4>相关装备</h4>
										</div>
										<div class="card-body">
											<div class="chart-holder">
												<div class="table-responsive">
													<table class="table table-styled mb-0" id="rang-good">
														<thead>
														<tr>
															<th style="display: none">ID</th>
															<th>图片</th>
															<th>名称</th>
															<th>当前价/￥</th>
															<th>原价/￥</th>
															<th>库存</th>
															<th>类型</th>
														</tr>
														</thead>
														<tbody>
														<tr>
															<td style="display: none">033</td>
															<td><img src="../picture/3.jpg" alt=" "></td>
															<td>2021</td>
															<td>$600</td>
															<td>
                                                        		<span class="img-thumb">
                                                            		<i class="fab fa-cc-paypal"></i>
                                                            		<span class="ml-2">Paypal</span>
                                                        		</span>
															</td>
															<td>...</td>
															<td>
																<label class="mb-0 badge badge-primary" title="" data-original-title="Pending">View Detail</label>
															</td>
															<td>
																<label class="mb-0 badge badge-primary" title="" data-original-title="Pending">View Detail</label>
															</td>
														</tr>
														</tbody>
													</table>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!--======End Index2 Product single Section======-->
            </div>
        </div>
    </div>

    <!-- Script Start -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
	<script src="../js/swiper.min.js"></script>
    <!-- Page Specific -->
    <script src="../js/nice-select.min.js"></script>
    <!-- Custom Script -->
    <script src="../js/custom.js"></script>

	<script type="text/javascript" src="../js/jquery-getUrlParam.js"></script>
	<!--页面详情中使用(或其他product.html?gid=#{gid}方式转递数据)-->
	<!--	可以通过../js/jquery-getUrlParam.js 获取	product.html?gid=#{gid} id的内容（let gid = $.getUrlParam("gid");）-->
	<script type="text/javascript">
		let gid = $.getUrlParam("gid");
		let categoryId = $.getUrlParam("category_id");
		$(document).ready(function() {
			$('#sidebar').load('sidebar.html'); //加载公共html部分
			$('#header').load('header.html'); //加载公共html部分
			$.ajax({
				url: "/goods/" + gid + "/details",
				type: "GET",
				dataType: "JSON",
				success: function(json) {
					if (json.state == 200) {
						// console.log("title=" + json.data.title);
						//html可以直接放数据，还可以加标签

						$("#good-image img").attr("src",json.data.image);
						$("#good-title").html(json.data.title);
						$("#good-price1").html(json.data.price);
						$("#good-price2").html(json.data.prices);
						$("#good-type").html(json.data.goodType);
						$("#good-num").html(json.data.num);


					} else if (json.state == 4003) { // 商品数据不存在的异常
						location.href = "index.html";
					} else {
						alert("获取商品信息失败！" + json.message);
					}
				}
			});

			$("#rang-good tbody").empty();
			$.ajax({
				url: "/goods/" + categoryId + "/get_rand",
				type: "GET",
				dataType: "JSON",
				success: function(json) {
					if (json.state == 200) {
						let list = json.data;
						for (let i = 0; i < list.length; i++) {
							let html = '<tr>'
									+ '<td><a href="product-single.html?gid=#{gid}&category_id=#{categoryId}">'
									+ '<img src="#{image}" alt=" " width="200px" height="200px"></a></td>">'
									+ '<td style="text-align: center;line-height: 200px;color: #00acee;font-size: 17px;">#{title}</td>'
									+ '<td style="text-align: center;line-height: 200px;color: #00acee">#{price}￥</td>'
									+ '<td style="text-align: center;line-height: 200px;color: #00acee">#{prices}￥</td>'
									+ '<td style="text-align: center;line-height: 200px">#{num}</td>'
									+ '<td style="text-align: center;line-height: 200px"><label class="mb-0 badge badge-primary" title="" data-original-title="Pending" type="button" class="add-good-to-cart">#{goodType}</label></td>'
									+ '</tr>';


							html = html.replace(/#{gid}/g, list[i].gid);
							html = html.replace(/#{categoryId}/g, list[i].categoryId);
							html = html.replace(/#{image}/g, list[i].image);
							html = html.replace(/#{title}/g, list[i].title);
							html = html.replace(/#{price}/g, list[i].price);
							html = html.replace(/#{prices}/g, list[i].prices);
							html = html.replace(/#{num}/g, list[i].num);
							html = html.replace(/#{goodType}/g, list[i].goodType);

							$("#rang-good tbody").append(html);
						}
					}else {
						alert("获取商品信息失败！" + json.message);
					}
				}
			});
		});

		$("#add-to-cart").click(function() {
			$.ajax({
				url: "/carts/add_to_cart",
				type: "POST",
				data: {
					"gid": gid,
					"amount": $("#num").val()
				},
				dataType: "JSON",
				success: function(json) {
					if (json.state == 200) {
						alert("增加购物车成功！");
					} else {
						alert("增加购物车失败！" + json.message);
					}
				},
				error: function(xhr) {
					alert("您的登录信息已经过期，请重新登录！HTTP响应码：" + xhr.status);
					location.href = "login.html";
				}
			});
		});

		$("#add-to-collect").click(function() {
			$.ajax({
				url: "/collects/" + gid + "/add_to_collect",
				type: "POST",
				dataType: "JSON",
				success: function(json) {
					if (json.state == 200) {
						alert("增加收藏成功！");
					} else {
						alert("增加收藏失败！" + json.message);
					}
				},
				error: function(xhr) {
					alert("您的登录信息已经过期，请重新登录！HTTP响应码：" + xhr.status);
					location.href = "login.html";
				}
			});
		});
	</script>
</body>

</html>